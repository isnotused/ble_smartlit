# 低功耗蓝牙信号优化系统 - Streamlit Web界面

## 📝 使用说明

### 1. 启动应用

- 推荐使用脚本启动：
  ```bash
  chmod +x run_streamlit.sh
  ./run_streamlit.sh
  ```
- 或者激活虚拟环境后直接运行：
  ```bash
  source .venv/bin/activate
  streamlit run streamlit_app_02.py --server.port 8501
  ```

### 2. 访问界面

- 浏览器打开 [http://localhost:8501](http://localhost:8501)

### 3. 主要界面结构

#### 🎛️ 侧边栏控制面板
- 运行模式选择：支持 optimize（优化）、demo（演示）、monitor（监控）、test（测试）、interactive（交互式）五种模式。
- 参数设置：可调节信号采集时长（0.01~1.0秒）、优化循环次数（1~100）、输出文件名。
- 快速操作按钮：一键启动各模式。

#### 🖥️ 主界面选项卡
- 实时监控：展示系统状态、处理延迟、信号质量、数据吞吐等核心指标，并有趋势图表。
- 数据分析：自动识别和分析优化结果 HDF5 文件，支持信号波形和特征矩阵可视化。
- 测试验证：支持 QPSK、OFDM、FSK、噪声等信号类型的测试，参数可调，结果以图表和指标展示。
- 优化系统：交互式展示完整信号优化流程，参数可调，实时显示优化效果。
- 系统信息：显示当前运行参数、模式、文件名等系统状态。

### 4. 典型操作流程

#### 🚀 优化模式
1. 在侧边栏选择“优化”模式，设置采集时长、循环次数、输出文件名。
2. 点击“开始优化”按钮。
3. 主界面实时显示进度、质量评分和趋势图。
4. 优化完成后自动保存结果到指定 HDF5 文件。

#### 🎭 演示模式
1. 选择“demo”模式，点击“演示模式”按钮。
2. 系统自动演示信号生成、优化、评估等流程。
3. 查看示例信号对比图表。

#### 📊 监控模式
1. 选择“monitor”模式，设置参数后点击“监控模式”按钮。
2. 实时监控系统性能指标和趋势。

#### 🧪 测试模式
1. 选择“test”模式，或在“测试验证”标签页配置信号类型、信噪比、长度等参数。
2. 点击“测试模式”或“运行测试”按钮。
3. 查看时域、频域分析图和测试结果。

#### 🧩 交互式优化
1. 选择“interactive”模式，进入“优化系统”标签页。
2. 按需调节参数，实时查看完整优化流程和效果。

### 5. 数据分析与导出
- 在“数据分析”标签页选择 HDF5 文件，点击“分析数据”即可自动展示信号波形、特征矩阵等。
- 支持结果导出和历史趋势分析。

### 6. 故障排查
- 如遇模块加载失败，系统自动切换到模拟模式，功能不受影响。
- 端口冲突可修改启动端口。
- 文件路径问题请确保在项目根目录启动。

---

🎉 现在即可体验专业的低功耗蓝牙信号优化与可视化！

## 🌟 功能特性

### 📊 主控面板
- **运行模式选择**: 支持 optimize（优化）、demo（演示）、monitor（监控）、test（测试）、interactive（交互式）五种模式
- **参数配置**: 可调节信号采集时长（0.01-1.0秒）、优化循环次数（1-100次）、输出文件名等关键参数
- **一键运行**: 通过按钮交互完全替代命令行参数，支持快速操作和批量处理
- **实时状态**: 动态显示系统运行状态、模块加载情况和当前执行进度

### 📈 实时监控
- **性能指标**: 实时显示系统状态、处理延迟、信号质量、数据吞吐量四大核心指标
- **多维图表**: 信号质量趋势、处理延迟监控、频谱分析、误码率监控四个维度的动态图表
- **进度跟踪**: 循环优化进度条、实时数据更新和状态提示信息
- **系统资源**: 监控CPU使用率、内存占用和网络吞吐量

### 📊 数据分析  
- **HDF5文件分析**: 自动识别项目目录中的优化结果文件，支持一键分析和可视化
- **信号可视化**: 展示增强信号波形、质量评分趋势、特征矩阵热图和统计分布
- **数据导出**: 支持JSON、CSV、HDF5多种格式的结果导出和历史数据分析
- **智能统计**: 自动计算平均质量、最佳质量、最低延迟、平均吞吐量等关键指标

### 🧪 测试验证
- **多类型信号**: 支持QPSK、OFDM、FSK、噪声四种标准信号类型的生成和测试
- **参数调节**: 可配置信噪比（-10dB到30dB）、信号长度（500-5000采样点）等测试参数
- **全面分析**: 提供实部时域、虚部时域、幅度谱、相位谱四个维度的完整分析
- **性能评估**: 自动计算信号功率、测试成功率和各项质量指标

### 🔧 优化系统（核心专利技术）
基于**低功耗蓝牙芯片信号接收优化专利技术**，实现完整的8步优化流程：

#### 🎯 环境数据采集
- **多通道射频前端**: 采集环境中信号强度、噪声功率和多径干扰数据
- **原始特征生成**: 通过多维度传感器生成原始环境特征集
- **时空关联分析**: 构建动态环境特征矩阵，捕获环境变化趋势

#### 🧠 注意力机制滤波策略
- **智能策略选择**: 基于注意力机制的滤波策略选择模型，自动输出最优滤波策略标识
- **多算法支持**: 集成Kalman、Wiener、LMS自适应、Butterworth、粒子滤波、小波阈值等多种滤波算法
- **动态权重分配**: 根据信号特性和环境条件自适应调整各滤波器权重

#### ⚡ 时频联合处理
- **三阶段处理**: 实现"动态时域滤波→自适应频域滤波→信号重构"的完整流程
- **参数自适应**: 根据最优滤波策略标识中的时域/频域参数动态调整处理参数
- **实时优化**: 生成初步优化信号，为后续深度增强提供高质量输入

#### 🔄 深度残差网络增强
- **分段加窗处理**: 对初步优化信号进行智能分段，避免边界效应
- **多尺度特征提取**: 提取不同尺度的信号特征，捕获细节和全局信息
- **跨层特征融合**: 通过残差网络实现跨层特征融合，修复信号细节失真
- **高质量输出**: 生成高质量的增强目标信号

#### 📏 多维质量评估
- **三类指标计算**: 计算信噪比(SNR)、误差向量幅度(EVM)、相关系数等核心指标
- **三维矩阵构建**: 构建包含质量、延迟、吞吐量的三维评估矩阵
- **滑动加权平均**: 通过滑动窗口和加权平均生成量化的信号质量评估矩阵

#### 🎛️ 参数动态调整
- **异常点分析**: 识别信号质量异常点和性能瓶颈
- **偏差计算**: 计算当前参数与最优参数的偏差程度
- **智能调整**: 根据质量评估矩阵动态调整RF增益、滤波截止频率、均衡器系数等接收参数
- **预测优化**: 建立环境特征与参数的动态映射关系，实现参数预调整

### 📋 系统信息
- **运行状态**: 显示当前运行模式、参数配置、文件输出路径等系统状态
- **模块监控**: 实时监控信号优化器、数据管理器、环境分析器等各模块状态
- **日志记录**: 提供系统启动、模块初始化、处理进度等详细日志信息
- **兼容模式**: 支持真实模块和模拟模式，确保在各种环境下都能正常运行

## 🚀 快速开始

### 1. 启动应用

**方法一：使用脚本启动**
```bash
chmod +x run_streamlit.sh
./run_streamlit.sh
```

**方法二：直接启动**
```bash
# 激活虚拟环境
source .venv/bin/activate

# 启动应用
streamlit run streamlit_app_simple.py --server.port 8501
```

### 2. 访问界面

在浏览器中打开：http://localhost:8501

### 3. 使用指南

#### 🎯 优化模式
1. 在侧边栏设置参数（采集时长、循环次数等）
2. 点击"开始优化"按钮
3. 观察实时进度和质量评分
4. 查看优化完成后的趋势图表

#### 🎭 演示模式  
1. 点击"演示模式"按钮
2. 观看系统演示流程
3. 查看生成的示例图表

#### 📊 监控模式
1. 设置监控参数
2. 点击"监控模式"按钮  
3. 实时查看系统性能指标

#### 🧪 测试模式
1. 在"测试验证"标签页配置测试参数
2. 选择信号类型和参数
3. 点击"运行测试"查看结果

## 🎨 界面特性

### 📱 响应式设计
- 支持不同屏幕尺寸
- 自适应布局和组件

### 🎯 交互控件
- **滑块控制**: 精确调节数值参数
- **下拉选择**: 选择运行模式和信号类型
- **按钮控制**: 一键启动各种功能
- **进度条**: 实时显示处理进度

### 📊 数据可视化
- **Plotly图表**: 交互式图表，支持缩放、平移
- **实时更新**: 动态更新的监控图表
- **多样化展示**: 时域、频域、统计图表等

### 🎨 美观界面
- **渐变色卡片**: 美观的指标展示
- **图标装饰**: 丰富的Emoji图标
- **色彩搭配**: 专业的配色方案

## 🔧 技术架构

### 🌐 前端技术
- **Streamlit**: Web应用框架
- **Plotly**: 交互式图表库  
- **Bootstrap CSS**: 样式美化

### 🔮 后端集成
- **模块化设计**: 支持真实模块和模拟模式
- **异常处理**: 完善的错误处理机制
- **数据管理**: HDF5文件读写和分析

### 📊 数据流
```
用户输入 → Streamlit控件 → 后端处理 → 结果展示 → 文件保存
```

## 📦 依赖环境

### 🔧 必需依赖
```bash
streamlit>=1.51.0
plotly>=5.0.0  
numpy>=1.21.0
pandas>=1.3.0
h5py>=3.0.0
matplotlib>=3.5.0
```

### 🚀 可选依赖
```bash
torch>=1.9.0          # 深度学习模块
scikit-learn>=1.0.0    # 机器学习模块  
scipy>=1.7.0           # 科学计算模块
```

## 🛠️ 配置说明

### ⚙️ 系统参数
- **duration**: 信号采集时长 (0.01-1.0秒)
- **cycles**: 优化循环次数 (1-100次)
- **output_file**: 结果保存文件名

### 🎛️ 测试参数  
- **signal_type**: 信号类型 (qpsk/ofdm/fsk/noise)
- **snr_db**: 信噪比 (-10dB到30dB)
- **length**: 信号长度 (500-5000采样点)

## 🔍 故障排除

### ❌ 模块加载失败
- 检查Python环境和依赖安装
- 使用模拟模式继续体验功能

### 🌐 端口冲突
```bash
# 使用不同端口启动
streamlit run streamlit_app_simple.py --server.port 8502
```

### 📁 文件路径问题
- 确保在项目根目录启动应用
- 检查相对路径配置

### 🔧 性能优化
- 减少循环次数以提高响应速度
- 关闭不必要的实时更新

## 📈 功能对比

| 功能 | 命令行版本 | Streamlit版本 |
|------|------------|---------------|  
| 参数配置 | 命令行参数 | 交互式控件 |
| 运行控制 | 终端命令 | 按钮点击 |
| 结果展示 | 文本输出 | 图表可视化 |
| 实时监控 | 无 | 动态更新 |
| 数据分析 | 需手动 | 自动化分析 |

## 🎯 使用建议

### 🚀 新手用户
1. 从演示模式开始了解系统
2. 使用默认参数进行优化
3. 在数据分析页面查看结果

### 🔧 高级用户
1. 调节详细参数进行优化
2. 使用监控模式分析性能
3. 通过测试模式验证算法

### 🧪 开发者
1. 查看模拟模式的实现
2. 扩展新的可视化组件
3. 集成更多算法模块

## 📞 技术支持

如有问题，请检查：
1. 依赖环境是否完整
2. 文件权限是否正确
3. 端口是否被占用
4. 浏览器是否支持现代特性

---

🎉 **享受可视化的蓝牙信号优化体验！**
