# 交互式信号优化模块使用指南

## 📋 概述

交互式信号优化模块是 `streamlit_app_simple.py` 的新增功能，允许用户实时调节射频前端的信号参数，并通过自适应滤波算法观察优化效果。

## 🚀 快速开始

### 启动应用

```powershell
cd c:\Users\Administrator\ble_smartlit
C:/Users/Administrator/ble_smartlit/.venv/Scripts/python.exe -m streamlit run streamlit_app_simple.py
```

应用将在浏览器中打开：http://localhost:8502

### 访问交互模块

1. 启动应用后，点击顶部的 **"🎛️ 交互优化"** 选项卡
2. 在左侧控制面板看到参数调节区域
3. 在右侧看到信号对比与分析显示区域

## 🎛️ 参数说明

### 1. 信号强度控制

#### 信号功率 (dBm)
- **范围**: -90 dBm 到 -50 dBm
- **默认值**: -70 dBm
- **说明**: 控制基础信号的功率强度，值越大信号越强

#### 信号波动 (dB)
- **范围**: 0 到 10 dB
- **默认值**: 2 dB
- **说明**: 信号功率的随机波动范围，模拟真实环境中的信号变化

### 2. 噪声功率控制

#### 噪声功率 (dBm)
- **范围**: -110 dBm 到 -70 dBm
- **默认值**: -90 dBm
- **说明**: 环境噪声的功率水平，值越大噪声越强

#### 噪声波动 (dB)
- **范围**: 0 到 5 dB
- **默认值**: 1 dB
- **说明**: 噪声功率的随机波动范围

### 3. 多径干扰控制

#### 多径强度
- **范围**: 0.0 到 2.0
- **默认值**: 1.0
- **说明**: 多径干扰的总体强度系数，值越大多径干扰越严重

#### 衰减速率
- **范围**: 0.5 到 5.0
- **默认值**: 2.0
- **说明**: 多径分量的指数衰减速率，值越大衰减越快

#### 多径数量
- **范围**: 3 到 15
- **默认值**: 10
- **说明**: 模拟的多径分量数量

### 4. 滤波策略

可选择以下四种自适应滤波算法：

1. **Kalman** - 卡尔曼滤波，适合处理线性高斯噪声
2. **Wiener** - 维纳滤波，基于最小均方误差准则
3. **LMS自适应** - 最小均方自适应滤波，适合时变信号
4. **Butterworth** - 巴特沃斯低通滤波，具有平坦的通带特性

### 5. 采样设置

#### 采样长度
- **范围**: 500 到 5000
- **默认值**: 2000
- **说明**: 生成的信号采样点数，影响处理时间和显示精度

## 📊 性能指标说明

### 信噪比 (SNR) 改善
- 显示优化前后的信噪比变化
- 单位：dB
- 正值表示信号质量提升

### 误差向量幅度 (EVM) 降低
- 衡量信号调制质量
- 单位：百分比
- 正值表示信号失真减少

### 信号相关度
- 优化信号与原始信号的相关性
- 范围：0 到 1
- 值越接近1表示信号恢复越好

## 📈 可视化图表

### 1. 原始信号 (实部)
显示无噪声的理想信号波形

### 2. 带噪信号 (实部)
显示添加噪声和多径干扰后的信号

### 3. 优化信号 (实部)
显示经过滤波算法优化后的信号，并叠加参考信号对比

### 4. 频谱对比
对比带噪信号和优化信号的频域特性

## 💡 使用技巧

### 1. 观察不同信噪比环境
- 尝试调整信号功率和噪声功率的比值
- 观察不同 SNR 下各滤波算法的表现

### 2. 测试多径干扰影响
- 增加多径强度和数量，观察信号失真
- 比较不同滤波算法对多径干扰的处理能力

### 3. 对比滤波策略
- 在相同参数下切换不同的滤波算法
- 观察各算法在不同场景下的优缺点

### 4. 极端条件测试
- 设置极低的信噪比（如信号 -80 dBm，噪声 -75 dBm）
- 测试算法的鲁棒性

## 🔧 技术实现

### 信号生成
- 调制方式：QPSK (四相相移键控)
- 载波频率：2.4 GHz (蓝牙频段)
- 采样率：2 MHz

### 滤波算法

#### Kalman 滤波
- 过程噪声方差 q = 0.1
- 测量噪声方差 r = 1.0

#### Wiener 滤波
- 窗口大小：32 个采样点

#### LMS 自适应滤波
- 步长 μ = 0.01
- 滤波器阶数：16

#### Butterworth 滤波
- 阶数：4
- 截止频率：0.1 (归一化频率)

## 📝 示例场景

### 场景 1：城市环境（强多径干扰）
```
信号功率: -70 dBm
噪声功率: -90 dBm
多径强度: 1.5
多径数量: 12
推荐算法: LMS自适应
```

### 场景 2：开阔环境（弱干扰）
```
信号功率: -65 dBm
噪声功率: -95 dBm
多径强度: 0.5
多径数量: 5
推荐算法: Butterworth
```

### 场景 3：高噪声环境
```
信号功率: -75 dBm
噪声功率: -80 dBm
多径强度: 1.0
多径数量: 8
推荐算法: Kalman
```

### 场景 4：时变信道
```
信号功率: -70 dBm (波动 5 dB)
噪声功率: -90 dBm (波动 2 dB)
多径强度: 1.2
推荐算法: LMS自适应
```

## 🐛 故障排除

### 应用无法启动
确保已安装所有依赖：
```powershell
pip install streamlit numpy pandas matplotlib plotly h5py scipy
```

### 图表显示异常
- 减小采样长度参数
- 刷新浏览器页面

### 滤波效果不明显
- 检查参数设置是否合理
- 尝试不同的滤波策略
- 增加信噪比差异

## 📚 相关文件

- `streamlit_app_simple.py` - 主应用文件
- `bluetooth_optimization/adaptive_ble_receiver/core/rf_frontend.py` - 射频前端模拟
- `bluetooth_optimization/adaptive_ble_receiver/core/adaptive_filter.py` - 自适应滤波实现

## 🔗 相关链接

- [Streamlit 文档](https://docs.streamlit.io/)
- [SciPy 信号处理](https://docs.scipy.org/doc/scipy/reference/signal.html)
- [蓝牙技术规范](https://www.bluetooth.com/specifications/)

## 📧 反馈与支持

如有问题或建议，请通过 GitHub Issues 反馈。

---

最后更新：2025-11-06
